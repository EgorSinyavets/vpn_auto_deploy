Скрипт для настройки сервера и установки VPN 

Можно запустить одной командой с сервера:
**bash -c "$(curl -L https://raw.githubusercontent.com/estraveler/vpn_auto_deploy/refs/heads/main/server_prepare_menu.sh)"**

Тестировался на Alma Linux 9 и Debian 11

Требования:
- RHEL like or Debian like OS

Возможности скрипта:
1) Установка и настройка vless+xray.

    Устанавливает xray при помощи официального скрипта, генерирует и заполняет все необходимые сущности. На выходе дает строку для вставки в клиенты (типа hiddify)
    ВАЖНО: Во время установки vless вы должны будете ввести маскировочный домен (в идеале вы должны сами его определить, пример www.amazon.com, www.microsoft.com)
    Плюсы - на текущий момент лучший по сложности обнаружения и безопасности. Минусы - работает не всегда стабильно, важно правильно подобрать маскировочный домен. 
    Предварительно рекомендуется с vps запустить команду curl -v -L --tlsv1.3 --http2 https://www.*ваш домен*. Если в ответ вы видите много логов и HTML-код, то домен можно использовать.

2) Полное удаление vless+xray.

    Удаление xray-vless и всех конфигов из первого пункта.

3) Очистка всех firewall правил.

    Собственно очистка правил, на случай, если соединения к серверу отбрасывает по таймауту, а вы что-то сами пытались сделать с firewall.

4) Настройка безопасности для xray .

    Этот пункт рекомендуется запускать после п.1 для настройка безопасного подключения к вашему серверу. Чтобы различные "доброжелатели" не хакнули ваш vps и не стали с него майнить или делать спам-рассылки.

5) Настройка безопасности для amnezia.

    Сама Amnezia - это тоже вид VPN (AmnesiaWG). Плюсы: Более шустрый и надежный, чем xray-vless. Минусы: чуть менее защищенный от обнаружения и гарантированно работает только на Debian 10/11/12 и Ubuntu 20/22. На alma/centos не работает. Ставится не через скрипт, а через свой инсталлятор https://amnezia.org/ru/downloads . Соответственно этот пункт выбираем для настройки безопасности уже после установки Amnezia через инсталлятор.

6) Добавить порт или адрес в firewall.

    Кастомные настройки, если на сервере крутится что-нибудь еще или у вас сменился домашний ip.

7) Смена ssh порта на кастомный.

    Также настройка для увеличения безопасности, рекомендуется. Будьте внимательны, после смены подключаться к серверу для администрирования нужно будет уже по новому порту. Кроме того, если вы перед этим настраивали безопасность через пункты 4-5 и выбирали доступ через открытый для всех порт то необходимо предварительно запустить п.6 и добавить планируемый ssh порт в исключения.








